@using BazaarCompanionWeb.Dtos

@{
    // Buy Calculations
    double buyPrice = Product.BuyOrderUnitPrice ?? 0;
    double buyDiff = BuyAverage > 0 ? ((buyPrice - BuyAverage) / BuyAverage) * 100 : 0;
    string buySign = buyDiff > 0 ? "+" : "";
    string buyColor = buyDiff >= 0 ? "text-emerald-400" : "text-rose-400";

    // Sell Calculations
    double sellPrice = Product.SellOrderUnitPrice ?? 0;
    double sellDiff = SellAverage > 0 ? ((sellPrice - SellAverage) / SellAverage) * 100 : 0;
    string sellSign = sellDiff > 0 ? "+" : "";
    string sellColor = sellDiff >= 0 ? "text-emerald-400" : "text-rose-400";

    var spreadPercent = (Product.OrderMetaMargin / Product.BuyOrderUnitPrice) * 100;
}
<div class="grid grid-cols-1 md:grid-cols-12 gap-4">

    <!-- 1. BUY CARD (Bid) -->
    <div
        class="md:col-span-5 relative group overflow-hidden rounded-2xl border border-emerald-500/30 bg-gradient-to-br from-emerald-900/20 to-slate-900/50 p-5 shadow-lg backdrop-blur-sm transition-all hover:border-emerald-500/50">
        <div class="flex justify-between items-start">
            <div>
                <p class="text-xs font-bold uppercase tracking-widest text-emerald-500 mb-1">Bid Price (Buy)</p>
                <div class="text-3xl font-black tracking-tight text-emerald-400">
                    @((Product.BuyOrderUnitPrice ?? 0).ToString("N2"))
                </div>
            </div>
            <!-- Icon/indicator -->
            <div class="p-2 rounded-lg bg-emerald-500/10 text-emerald-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                </svg>
            </div>
        </div>
        <!-- Historical Context -->
        <div class="mt-4 flex items-center justify-between text-xs font-medium">
            <span class="text-emerald-600/80">Avg: @BuyAverage.ToString("N2")</span>
            <span class="@buyColor bg-slate-950/30 px-2 py-0.5 rounded-md border border-slate-700/50">
                @buySign@buyDiff.ToString("F2")%
            </span>
        </div>
    </div>

    <!-- 2. SPREAD CARD (The Bridge) -->
    <div
        class="md:col-span-2 flex flex-col justify-center items-center rounded-2xl border border-slate-700 bg-slate-800/60 p-4 shadow-inner text-center">
        <p class="text-[10px] uppercase text-slate-500 font-semibold tracking-wider">Spread</p>
        <div class="text-xl font-bold text-white my-1">
            @Product.OrderMetaMargin.ToString("N2")
        </div>
        <!-- Margin Badge -->
        <span class="inline-flex items-center rounded-full bg-slate-700 px-2 py-0.5 text-[10px] font-medium text-slate-300">
            @(spreadPercent?.ToString("F2"))%
        </span>
    </div>

    <!-- 3. SELL CARD (Ask) -->
    <div
        class="md:col-span-5 relative group overflow-hidden rounded-2xl border border-rose-500/30 bg-gradient-to-br from-rose-900/20 to-slate-900/50 p-5 shadow-lg backdrop-blur-sm transition-all hover:border-rose-500/50">
        <div class="flex justify-between items-start">
            <div>
                <p class="text-xs font-bold uppercase tracking-widest text-rose-500 mb-1">Ask Price (Sell)</p>
                <div class="text-3xl font-black tracking-tight text-rose-400">
                    @((Product.SellOrderUnitPrice ?? 0).ToString("N2"))
                </div>
            </div>
            <div class="p-2 rounded-lg bg-rose-500/10 text-rose-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"/>
                </svg>
            </div>
        </div>
        <div class="mt-4 flex items-center justify-between text-xs font-medium">
            <span class="text-rose-600/80">Avg: @SellAverage.ToString("N2")</span>
            <span class="@sellColor bg-slate-950/30 px-2 py-0.5 rounded-md border border-slate-700/50">
                @sellSign@sellDiff.ToString("F2")%
            </span>
        </div>
    </div>

</div>
