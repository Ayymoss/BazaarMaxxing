@using BazaarCompanionWeb.Models.Api.Items
@using BazaarCompanionWeb.Utilities

<div class="relative overflow-hidden shrink-0 select-none flex items-center justify-center transition-all duration-300 @Class"
     style="width: @(Size)px; height: @(Size)px; border: @(Border)px solid @(Tier.ProductTierColor()); background-color: @(SkinUrl == null ? Tier.ProductTierColor() + "10" : "#1e293b"); @Style">
    @if (!string.IsNullOrEmpty(SkinUrl))
    {
        <!-- Face Layer -->
        <div style="width: 100%; height: 100%;
            background-image: url('@SkinUrl');
        background-size: 800%;
        background-position: -100% -100%;
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;">
        </div>

        <!-- Hat/Overlay Layer -->
        <div style="width: 100%; height: 100%;
            position: absolute;
            top: 0; left: 0;
            background-image: url('@SkinUrl');
        background-size: 800%;
        background-position: -500% -100%;
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;">
        </div>
    }
    else
    {
        <!-- Creative Fallback: Stylized Block Silhouette -->
        <div class="flex flex-col items-center justify-center opacity-40">
            <i class="ph ph-cube text-white" style="font-size: @(Size * 0.5)px"></i>
        </div>
    }
</div>

@code {
    [Parameter] public string? SkinUrl { get; set; }
    [Parameter] public ItemTier Tier { get; set; } = ItemTier.Common;
    [Parameter] public int Size { get; set; } = 32;
    [Parameter] public string? Alt { get; set; }
    [Parameter] public string? Class { get; set; }
    [Parameter] public int Border { get; set; } = 2;
    [Parameter] public string? Style { get; set; }
}
